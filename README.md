# P!Ccut - まとめてトリミング ©️2025 KisaragiIchigo

## ツール概要

画像の余白（白 or 黒）を**自動検出**して一括トリミングするデスクトップツール。
ウィンドウ**どこにドラッグ＆ドロップしてもOK**、**重い画像でも固まらない**非同期(QThread)処理、
**プレビューに検出枠**をオーバーレイ表示。設定（検出色/方向/余白％/ウィンドウ位置とサイズ）は自動保存＆復元。

---

## **オプション機能**:

* **対応形式**：PNG / JPG / JPEG / BMP / GIF / TIFF / **WEBP**（透明WEBP対応）
* **ドラッグ＆ドロップ（全域）**：ファイル/複数/フォルダ投入で即処理（ボタン実行も可）
* **プレビュー＆検出枠**：トリミング予定範囲を赤破線で可視化
* **非同期処理**：QThreadでUIノンブロッキング、キャンセルも可能
* **余白追加（％）**：仕上げに白キャンバス/透過キャンバスで余白付与
* **設定永続化**：検出色/方向/余白％/ウィンドウ位置・サイズ/最大化を自動保存
* **PyInstaller `--onefile`** 運用に最適化（アイコン同梱、\_MEIPASS考慮）

#### 特長

* **端から走査する検出アルゴリズム**：画像の端から走査し「背景じゃない色」が出た最初の座標を境界に採用
* **透明対策**：検出は“白/黒に合成したRGB”で実施、実切り取りは元画像モードのまま
* **安全な保存**：拡張子に応じて保存モード自動選択（JPEG系はRGB変換、PNG/WEBPはα保持）

## 使い方

1. ツールを起動（初回は既定サイズ、以後は前回のウィンドウ位置/サイズを復元）。
2. 右ペインのメニューで以下を設定：

   * **検出カラー（プルダウン）**：白背景検出 / 黒背景検出
   * **トリミング方向（プルダウン）**：左右 / 上下 / 両方
   * **□ 余白を残す（％）**：必要なら数値を指定（0–50）
3. 画像の投入方法は2通り：

   * **ドラッグ＆ドロップ**（ウィンドウ全域OK）→ 自動で処理開始
   * **ボタン実行**：「画像選択」または「フォルダ選択」で対象を選び、「処理開始」
4. **プレビュー**：単一画像投入時、赤い破線の枠が「切れる範囲」。
5. 処理中はプログレスバーが進行。必要なら「中止」でキャンセル。
6. 出力は元画像と同じ階層に\*\*`Remake/`\*\* フォルダを作り、同名ファイルで保存。
7. 終了時に設定が保存され、次回起動時に自動で復元。

---

## 注意事項

* JPEG/BMPはα非対応のため、透過画像を保存するときは自動でRGBに変換されます（透過は失われます）。
* 透明WEBP/PNGは検出時に白/黒へ合成して境界を求めますが、**切り抜き後もαは保持**されます（保存形式がα対応の場合）。
* 背景が完全な白/黒でない場合は、まれに境界検出が甘くなることがあります（デフォルト閾値：70）。
* 大量ファイル処理時はディスクI/Oがボトルネックになることがあります。SSD推奨。

---

## ファイル構成

```
PicCut/
├─ piccut.py         # 起動エントリ（QApplication起動・フォント設定）
├─ gui.py            # メインGUI：左プレビュー/右メニュー、全域D&D、QThread非同期
├─ ui_common.py      # QSS/ドロップシャドウ/フレームレス移動/アイコン適用
├─ processor.py      # 検出・トリミング本体（WEBP/透明対応、拡張子別保存）
├─ config.py         # 設定保存/復元（検出色/方向/余白%/ウィンドウ位置サイズ/最大化）
├─ readme.py         # アプリ内READMEダイアログ（📘）
└─ piccut.ico        # アイコン（任意、PyInstaller同梱）
```

---

## ライセンス

MIT License ©️ 2025 KisaragiIchigo
